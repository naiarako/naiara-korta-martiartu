<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Naiara  Korta Martiartu


  | USCT - design

</title>
<meta name="description" content="Personal webpage of Naiara Korta Martiartu. Based on [*folio](https://github.com/bogoli/-folio) design.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<!--link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" /-->


<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ¦‡</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="/projects/2_project/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class=" sticky-bottom-footer">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm sticky-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
       <span class="font-weight-bold">Naiara</span>   Korta Martiartu
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/outreach/">
                outreach
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/research/">
                research
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/teaching/">
                teaching
                
              </a>
          </li>
          
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      <div class="post">

  <header class="post-header">
    <h1 class="post-title">USCT - design</h1>
    <p class="post-description">Optimal Experimental Design methods for USCT</p>
  </header>

  <article>
    <p>There are mainly two classes of USCT devices depending on the data coverage they provide (see examples in figure below):</p>

<p>(1) Two-dimensional (2D) devices arrange the transducers in a plane (e.g., in a ring-shaped transducer holder) and produce a set of 2D breast images at different elevations. This arrangement is helpful to reduce the dimension of the physical problem and speed up the image reconstruction process. It enables us to use sophisticated tomographic methods (numerically solving the wave equation) that otherwise would be computationally prohibitive to implement. However, fast reconstructions neglect the three-dimensional nature of the wave propagation (e.g., out-of-plane scattering) and introduce artifacts in the final images, reducing their accuracy.</p>

<p>(2) Three-dimensional (3D) devices arrange transducers in a semispherical setup and can provide volumetric tissue images at the expense of a higher acquisition and computational cost. Currently, this cost does not allow the implementation of advanced tomographic methods and significantly limits the spatial resolution of final images.</p>

<div class="row justify-content-center">
    <div class="col-sm-8 mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/2D&amp;3DUSCT.png" alt="" title="USCT devices" />
    </div>
</div>
<div class="caption">
Example of 2D (left) and 3D (right) ultrasound computer tomography devices. Image sources: <a href="https://journals.lww.com/investigativeradiology/Fulltext/2017/06000/Ultrasound_Tomography_Evaluation_of_Breast.4.aspx" target="_blank">2D</a> and <a href="http://ipeusctdb1.ipe.kit.edu/~usct/challenge/?page_id=92" target="_blank">3D</a>
</div>

<p>As we see, USCT designs and tomographic methods are interrelated. My work has focused on developing Optimal Experimental Design (OED) approaches to find the optimal configuration of transducers for commonly applied image reconstruction methods. We define the optimal setup as the configuration of transducers that reduces most uncertainties of reconstructed images post-acquisition. More details can be found in my <a href="https://www.research-collection.ethz.ch/handle/20.500.11850/416172">Ph.D. thesis</a>.</p>

<h4> Optimal experimental design </h4>
<h5> Theoretical background </h5>

<p>The goal of USCT is to estimate the acoustic tissue parameters \(\mathbf{m}\) from the observations of the ultrasound signals \(\mathbf{d}\) that are recorded by an experimental setup \(\mathbf{s}\).
We can express the physical model relating our observations with unknown tissue properties as
\(\mathbf{F}\) as</p>

<p>\begin{equation}
\mathbf{d} = \mathbf{F}(\mathbf{m};\mathbf{s}) + \epsilon,
\end{equation}
where \(\mathbf{F}\) is the forward operator encoding our physical model, and \(\epsilon\) accounts for measurement noise. In USCT, the nonlinearities of \(\mathbf{F}\) with respect to \(\mathbf{m}\) are not too severe, and we typically use linearized forward operators with respect to some prior knowledge about tissue \(\mathbf{m}_p\):</p>

<p>\begin{equation}
\mathbf{F}(\mathbf{m};\mathbf{s}) \approx \mathbf{F}(\mathbf{m}_p;\mathbf{s}) +  \mathbf{F}â€™(\mathbf{m}_p;\mathbf{s})(\mathbf{m} - \mathbf{m}_p),
\end{equation}</p>

<p>For such linearized problems, we can compute the posterior covariance operator \(\Gamma_\text{post}\). This operator contains the uncertainties in tissue properties that we expect post-reconstruction and is expressed as</p>

<p>\begin{equation}
\Gamma_\text{post}(\mathbf{s}) = 
\left( {\mathbf{F}â€™(\mathbf{s})}^{T} \Gamma_\text{noise}^{-1}\mathbf{F}â€™(\mathbf{s}) + \Gamma_\text{prior}^{-1}\right)^{-1}.
\end{equation}</p>

<p>Here, \(\Gamma_\text{noise}\) and \(\Gamma_\text{prior}\) are the covariance operator of measurements noise and our prior knowledge about tissue properties, respectively, which we assume to be Gaussian. \(\Gamma_\text{post}\) shows useful properties to measure the quality of an experimental configuration. First, it depends on the parameters that define the experimental setup \(\mathbf{s}\). This allows us to compare different candidates and select the ones that give the lowest uncertainties in the parameter estimation. Second, it neither depends on the observations nor the unknown model parameters, which means that it could be used to optimize the experiment before any realization. Last, it shows the same structure for any forward operator, under the condition that these are linear or can be linearized with respect to the model parameters. This allows us to present general formulations of the OED problem, independent of the tomographic method that is intended to be applied post-acquisition.</p>

<h5> Optimal experimental design approach </h5>

<p>Assume that \(\Theta\) is a scalar function that quantifies the level of expected uncertainties in the parameters by extracting some properties from \(\Gamma_\text{post}\). Then, we can formulate the OED problem as a minimization problem</p>

<p>\begin{equation}\label{eq:OED}
\min_{\mathbf{s} \in \mathcal{S}}  \Theta \left(\Gamma_\text{post}\right),
\end{equation}</p>

<p>where \(\mathcal{S}\) represents the space for all possible experimental configurations. In our work, we define \(\Theta\) as the determinant of the posterior covariance matrix</p>

<p>\begin{equation}\label{eq:D-optLog}
\Theta = \log \det \left(\Gamma_\text{post} \ \right).
\end{equation}</p>

<p>The determinant corresponds to the product of the eigenvalues of \(\Gamma_\text{post}\), and thus, we minimize the volume of the uncertainty ellipsoid in the estimated tissue parameters. From information theory, this quantity can be related to the expected information gain.</p>

<p>To optimize the experimental setup in USCT, we use a sequential approach. We start from an experimental configuration that considers all candidate transducers active, and we deactivate them one by one in each iteration. This approach has the advantage of providing benefit-cost curves that illustrate the gain in the data information content with respect to the experimental cost:</p>

<div class="row justify-content-center">
    <div class="col-sm-5 mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/CostBenefitCurve.png" alt="" title="CostBenefitCurve" />
    </div>
</div>
<div class="caption">
Illustrative example of the benefit-cost curve obtained from sequential OED approach.
</div>

<p>The benefit-cost curve is particularly useful maximize the benefit-cost ratio of the experiment by identifying redundancies in our observations.</p>

<h5> Examples </h5>

<p>Here we show few results to illustrate the benefit of optimally designing an experiment. We consider the experimental data that was provided as part of the SPIE USCT Data Challenge 2017 by the Spanish National Research Council (CISC) and the Complutense University of Madrid (the data can be found <a href="http://ipeusctdb1.ipe.kit.edu/~usct/challenge/?page_id=183">here</a>). The setup consists of two transducer arrays of 16 elements. The transducers in one array act as emitters whereas the ones in the other array are recording. The receiving array is always located opposite to the emitting array, and the whole the whole system is rotated into 23 different positions, describing a circle with radius 95 mm. Receivers record signals that travel through a tissue mimicking phantom based on water, gelatine, graphite powder, and alcohol. The phantom has a cylindrical homogeneous background with a diameter of 94 mm, two inclusions of 2 cm diameter (lower and higher speed of sound than the background), and two steel needles.</p>

<p>Our goal is to decrease the data volume to reduce the time to solution. Here, the number of measurements is mainly controlled by the total number of emitting elements in the transducer array. We therefore aim to select the most informative ones, removing those that provide redundant information about the phantom. After applying our OED algorithm, we obtain the following result for the reconstruction of phantom speed of sound and reflectivity:</p>

<div class="row justify-content-center">
    <div class="col-sm-12 mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/Results_OED.png" alt="" title="Results_OED" />
    </div>
</div>
<div class="caption">
(Left) The benefit-cost curve indicating that four emitters per rotation are sufficient for accurate reconstructions. (Right) Reconstructed images for reflectivity (top) and speed of sound (bottom) using optimally selected emitters and the original setup with all the emitters. We can observe that both setups provide same image quality, meaning that by including more than four emitters, we record ultrasound signals that provide redundant information about the medium. These results consider delay-and-sum approach to image tissue reflectivity and <a href="https://naiarako.github.io/projects/1_project/" target="_blank">finite-frequency tomography method</a> for the speed of sound.

</div>

<p>To understand the meaning of the benefit-cost curve, we show the speed-pf-sound reconstructions that we acquire for different number of emitters:</p>

<div class="row justify-content-center">
    <div class="col-sm-11 mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/OED_supplem.png" alt="" title="OED_example" />
    </div>
</div>
<div class="caption">
Reconstructed speed-of-sound distribution using two, three, and four emitters per rotation, respectively. By including more emitters in the experiment, we add new information about tissue speed of sound, and the accuracy of the reconstruction improves.  
</div>

<p>For the experimental data used in this example, we could speed-up by four the acquisition and reconstruction time by optimally designing the experiment, without losing relevant information about the tissue. That is, in this example, 75% of the data is redundant!</p>

<p><strong>The benefit of an optimized USCT system, in terms of the image quality and computational resources, for clinical practice is tremendous. Once the acquisition system is optimized, the impact of the reduced cost in the recursive use of the scanning system may become very significant.</strong></p>

  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="sticky-bottom mt-5">
  <div class="container">
    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.

    
    
    Last updated: February 19, 2024.
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
